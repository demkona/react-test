{"ast":null,"code":"import _regeneratorRuntime from\"/home/dmytro/\\u0421\\u0442\\u0456\\u043B\\u044C\\u043D\\u0438\\u0446\\u044F/goit/react-fundamental-course-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/dmytro/\\u0421\\u0442\\u0456\\u043B\\u044C\\u043D\\u0438\\u0446\\u044F/goit/react-fundamental-course-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/dmytro/\\u0421\\u0442\\u0456\\u043B\\u044C\\u043D\\u0438\\u0446\\u044F/goit/react-fundamental-course-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/dmytro/\\u0421\\u0442\\u0456\\u043B\\u044C\\u043D\\u0438\\u0446\\u044F/goit/react-fundamental-course-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import PostService from\"../API/PostService\";import{usePosts}from\"../hooks/usePosts\";import{useFetching}from\"../hooks/useFetching\";import{getPageCount}from\"../utils/pages\";import MyButton from\"../components/UI/button/MyButton\";import PostForm from\"../components/PostForm\";import MyModal from\"../components/UI/MyModal/MyModal\";import PostFilter from\"../components/PostFilter\";import PostList from\"../components/PostList\";import Loader from\"../components/UI/Loader/Loader\";import Pagination from\"../components/UI/pagination/Pagination\";import{useObserver}from\"../hooks/useObserver\";import MySelect from\"../components/UI/select/MySelect\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Posts(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState({sort:'',query:''}),_useState4=_slicedToArray(_useState3,2),filter=_useState4[0],setFilter=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modal=_useState6[0],setModal=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),totalPages=_useState8[0],setTotalPages=_useState8[1];var _useState9=useState(10),_useState10=_slicedToArray(_useState9,2),limit=_useState10[0],setLimit=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),page=_useState12[0],setPage=_useState12[1];var sortedAndSearchedPosts=usePosts(posts,filter.sort,filter.query);var lastElement=useRef();var _useFetching=useFetching(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(limit,page){var response,totalCount;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return PostService.getAll(limit,page);case 2:response=_context.sent;setPosts([].concat(_toConsumableArray(posts),_toConsumableArray(response.data)));totalCount=response.headers['x-total-count'];setTotalPages(getPageCount(totalCount,limit));case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}()),_useFetching2=_slicedToArray(_useFetching,3),fetchPosts=_useFetching2[0],isPostsLoading=_useFetching2[1],postError=_useFetching2[2];useObserver(lastElement,page<totalPages,isPostsLoading,function(){setPage(page+1);});useEffect(function(){fetchPosts(limit,page);},[page,limit]);var createPost=function createPost(newPost){setPosts([].concat(_toConsumableArray(posts),[newPost]));setModal(false);};var removePost=function removePost(post){setPosts(posts.filter(function(p){return p.id!==post.id;}));};var changePage=function changePage(page){setPage(page);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(MyButton,{style:{marginTop:30},onClick:function onClick(){return setModal(true);},children:\"Add post\"}),/*#__PURE__*/_jsx(MyModal,{visible:modal,setVisible:setModal,children:/*#__PURE__*/_jsx(PostForm,{create:createPost})}),/*#__PURE__*/_jsx(\"hr\",{style:{margin:'15px 0'}}),/*#__PURE__*/_jsx(PostFilter,{filter:filter,setFilter:setFilter}),/*#__PURE__*/_jsx(MySelect,{value:limit,onChange:function onChange(value){return setLimit(value);},defaultValue:\"page\",options:[{value:5,name:'5'},{value:10,name:'10'},{value:25,name:'25'},{value:-1,name:'all post'}]}),postError&&/*#__PURE__*/_jsxs(\"h1\",{children:[\"Error $\",postError]}),/*#__PURE__*/_jsx(PostList,{remove:removePost,posts:sortedAndSearchedPosts,title:\"Post\"}),/*#__PURE__*/_jsx(\"div\",{ref:lastElement,style:{height:20,background:'red'}}),isPostsLoading&&/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:50},children:/*#__PURE__*/_jsx(Loader,{})}),/*#__PURE__*/_jsx(Pagination,{page:page,changePage:changePage,totalPages:totalPages})]});}export default Posts;","map":{"version":3,"names":["React","useEffect","useRef","useState","PostService","usePosts","useFetching","getPageCount","MyButton","PostForm","MyModal","PostFilter","PostList","Loader","Pagination","useObserver","MySelect","jsx","_jsx","jsxs","_jsxs","Posts","_useState","_useState2","_slicedToArray","posts","setPosts","_useState3","sort","query","_useState4","filter","setFilter","_useState5","_useState6","modal","setModal","_useState7","_useState8","totalPages","setTotalPages","_useState9","_useState10","limit","setLimit","_useState11","_useState12","page","setPage","sortedAndSearchedPosts","lastElement","_useFetching","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","totalCount","wrap","_callee$","_context","prev","next","getAll","sent","concat","_toConsumableArray","data","headers","stop","_x","_x2","apply","arguments","_useFetching2","fetchPosts","isPostsLoading","postError","createPost","newPost","removePost","post","p","id","changePage","className","children","style","marginTop","onClick","visible","setVisible","create","margin","value","onChange","defaultValue","options","name","remove","title","ref","height","background","display","justifyContent"],"sources":["/home/dmytro/Стільниця/goit/react-fundamental-course-test/src/pages/Posts.jsx"],"sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport PostService from \"../API/PostService\";\nimport {usePosts} from \"../hooks/usePosts\";\nimport {useFetching} from \"../hooks/useFetching\";\nimport {getPageCount} from \"../utils/pages\";\nimport MyButton from \"../components/UI/button/MyButton\";\nimport PostForm from \"../components/PostForm\";\nimport MyModal from \"../components/UI/MyModal/MyModal\";\nimport PostFilter from \"../components/PostFilter\";\nimport PostList from \"../components/PostList\";\nimport Loader from \"../components/UI/Loader/Loader\";\nimport Pagination from \"../components/UI/pagination/Pagination\";\nimport {useObserver} from \"../hooks/useObserver\";\nimport MySelect from \"../components/UI/select/MySelect\";\n\n\nfunction Posts() {\n    const [posts, setPosts] = useState([])\n    const [filter, setFilter] = useState({sort: '', query: ''})\n    const [modal, setModal] = useState(false);\n    const [totalPages, setTotalPages] = useState(0);\n    const [limit, setLimit] = useState(10);\n    const [page, setPage] = useState(1);\n    const sortedAndSearchedPosts = usePosts(posts, filter.sort, filter.query);\n    const lastElement = useRef()\n\n    const [fetchPosts, isPostsLoading, postError] = useFetching(async (limit, page) => {\n        const response = await PostService.getAll(limit, page);\n        setPosts([...posts, ...response.data])\n        const totalCount = response.headers['x-total-count']\n        setTotalPages(getPageCount(totalCount, limit));\n    })\n\n    useObserver(lastElement, page < totalPages, isPostsLoading, () => {\n        setPage(page + 1);\n    })\n\n    useEffect(() => {\n        fetchPosts(limit, page)\n    }, [page, limit])\n\n    const createPost = (newPost) => {\n        setPosts([...posts, newPost])\n        setModal(false)\n    }\n\n    const removePost = (post) => {\n        setPosts(posts.filter(p => p.id !== post.id))\n    }\n\n    const changePage = (page) => {\n        setPage(page)\n    }\n\n    return (\n        <div className=\"App\">\n            <MyButton style={{marginTop: 30}} onClick={() => setModal(true)}>\n                Add post\n            </MyButton>\n            <MyModal visible={modal} setVisible={setModal}>\n                <PostForm create={createPost}/>\n            </MyModal>\n            <hr style={{margin: '15px 0'}}/>\n            <PostFilter\n                filter={filter}\n                setFilter={setFilter}\n            />\n            <MySelect\n                value={limit}\n                onChange={value => setLimit(value)}\n                defaultValue=\"page\"\n                options={[\n                    {value: 5, name: '5'},\n                    {value: 10, name: '10'},\n                    {value: 25, name: '25'},\n                    {value: -1, name: 'all post'},\n                ]}\n            />\n            {postError &&\n            <h1>Error ${postError}</h1>\n            }\n            <PostList remove={removePost} posts={sortedAndSearchedPosts} title=\"Post\"/>\n            <div ref={lastElement} style={{height: 20, background: 'red'}}/>\n            {isPostsLoading &&\n            <div style={{display: 'flex', justifyContent: 'center', marginTop: 50}}><Loader/></div>\n            }\n            <Pagination\n                page={page}\n                changePage={changePage}\n                totalPages={totalPages}\n            />\n        </div>\n    );\n}\n\nexport default Posts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}